zerops:
  - setup: dotnet0
    build:
      base: dotnet@8

      buildCommands:
        - dotnet tool restore  # Restore any tools (if you have tool manifest)
        - dotnet tool install --global dotnet-ef  # Ensure dotnet-ef is available

        - dotnet build -o app  # Build the app

      deployFiles: app/~

    run:
      base: dotnet@8
      ports:
        - port: 7100
          httpSupport: true
      start: |
        # Run migrations before starting the app
        dotnet api.dll --migrate
